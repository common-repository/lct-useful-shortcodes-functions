!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.lazyframe=t()}(this,function(){"use strict";var s,a,o,u,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,i=arguments[t];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e};return o={vendor:s=void 0,id:void 0,src:void 0,thumbnail:void 0,title:void 0,apikey:void 0,initialized:!(a=[]),parameters:void 0,y:void 0,debounce:250,lazyload:!0,initinview:!1,onLoad:function(e){},onAppend:function(e){},onThumbnailLoad:function(e){}},u={regex:{youtube_nocookie:/(?:youtube-nocookie\.com\/\S*(?:(?:\/e(?:mbed))?\/|watch\?(?:\S*?&?v\=)))([a-zA-Z0-9_-]{6,11})/,youtube:/(?:youtube\.com\/\S*(?:(?:\/e(?:mbed))?\/|watch\?(?:\S*?&?v\=))|youtu\.be\/)([a-zA-Z0-9_-]{6,11})/,vimeo:/vimeo\.com\/(?:video\/)?([0-9]*)(?:\?|)/,vine:/vine.co\/v\/(.*)/},condition:{youtube:function(e){return!(!e||11!=e[1].length)&&e[1]},youtube_nocookie:function(e){return!(!e||11!=e[1].length)&&e[1]},vimeo:function(e){return!!(e&&9===e[1].length||8===e[1].length)&&e[1]},vine:function(e){return!(!e||11!==e[1].length)&&e[1]}},src:{youtube:function(e){return"https://www.youtube.com/embed/"+e.id+"/?"+e.parameters},youtube_nocookie:function(e){return"https://www.youtube-nocookie.com/embed/"+e.id+"/?"+e.parameters},vimeo:function(e){return"https://player.vimeo.com/video/"+e.id+"/?"+e.parameters},vine:function(e){return"https://vine.co/v/"+e.id+"/embed/simple"}},endpoints:{youtube:function(e){return"https://www.googleapis.com/youtube/v3/videos?id="+e.id+"&key="+e.apikey+"&fields=items(snippet(title,thumbnails))&part=snippet"},youtube_nocookie:function(e){return"https://www.googleapis.com/youtube/v3/videos?id="+e.id+"&key="+e.apikey+"&fields=items(snippet(title,thumbnails))&part=snippet"},vimeo:function(e){return"https://vimeo.com/api/oembed.json?url=https%3A//vimeo.com/"+e.id},vine:function(e){return"https://vine.co/oembed.json?url=https%3A%2F%2Fvine.co%2Fv%2F"+e.id}},response:{youtube:{title:function(e){return e.items[0].snippet.title},thumbnail:function(e){e=e.items[0].snippet.thumbnails;return(e.maxres||e.standard||e.high||e.medium||e.default).url}},youtube_nocookie:{title:function(e){return e.items[0].snippet.title},thumbnail:function(e){e=e.items[0].snippet.thumbnails;return(e.maxres||e.standard||e.high||e.medium||e.default).url}},vimeo:{title:function(e){return e.title},thumbnail:function(e){return e.thumbnail_url}},vine:{title:function(e){return e.title},thumbnail:function(e){return e.thumbnail_url}}}},function(e){if(s=r({},o,arguments.length<=1?void 0:arguments[1]),"string"==typeof e)for(var t=document.querySelectorAll(e),n=0;n<t.length;n++)l(t[n]);else if(void 0===e.length)l(e);else if(1<e.length)for(var i=0;i<e.length;i++)l(e[i]);else l(e[0]);s.lazyload&&function(){function e(e,t){e.settings.initialized=!0,e.el.classList.add("lazyframe--loaded"),i--,d(e),e.settings.initinview&&e.el.click(),e.settings.onLoad.call(n,e)}var n=this,t=window.innerHeight,i=a.length,o=(a.filter(function(e){return e.settings.y<t}).forEach(e),function(n,i){var o=void 0;return function(){var e=this,t=arguments;clearTimeout(o),o=setTimeout(function(){o=null,n.apply(e,t)},i)}}(function(){u=r<window.pageYOffset,r=window.pageYOffset,u&&a.filter(function(e){return e.settings.y<t+r&&!1===e.settings.initialized}).forEach(e),0===i&&window.removeEventListener("scroll",o,!1)},s.debounce)),r=0,u=!1;window.addEventListener("scroll",o,!1)}()};function l(t){var n,i=this;t instanceof HTMLElement==0||t.classList.contains("lazyframe--loaded")||((n={el:t,settings:function(e){var t=Array.prototype.slice.apply(e.attributes).filter(function(e){return""!==e.value}).reduce(function(e,t){return e[0===t.name.indexOf("data-")?t.name.split("data-")[1]:t.name]=t.value,e},{}),e=r({},s,t,{y:e.offsetTop,parameters:function(e){e=e.split("?");if(e[1])return-1!==(e=e[1]).indexOf("autoplay")?e:e+"&autoplay=1";return"autoplay=1"}(t.src)});e.vendor&&(t=e.src.match(u.regex[e.vendor]),e.id=u.condition[e.vendor](t));return e}(t)}).el.addEventListener("click",function(){n.el.appendChild(n.iframe);var e=t.querySelectorAll("iframe");n.settings.onAppend.call(i,e[0])}),s.lazyload?c(n):d(n,n.settings.thumbnail))}function d(n){var t,i,o,e,r=this;!(e=n.settings).vendor||e.title&&e.thumbnail||!("youtube"!==e.vendor&&"youtube_nocookie"!==e.vendor||e.apikey)?c(n,!0):(t=n,i=function(e,t){e||(e=t[0],(t=t[1]).settings.title||(t.settings.title=u.response[t.settings.vendor].title(e)),t.settings.thumbnail||(e=u.response[t.settings.vendor].thumbnail(e),t.settings.thumbnail=e,n.settings.onThumbnailLoad.call(r,e)),c(t,!0))},e=u.endpoints[t.settings.vendor](t.settings),(o=new XMLHttpRequest).open("GET",e,!0),o.onload=function(){var e;200<=o.status&&o.status<400?(e=JSON.parse(o.responseText),i(null,[e,t])):i(!0)},o.onerror=function(){i(!0)},o.send())}function c(e,t){var n;e.iframe=function(e){var t=document.createDocumentFragment(),n=document.createElement("iframe");e.vendor&&(e.src=u.src[e.vendor](e)),n.setAttribute("id","lazyframe-"+e.id),n.setAttribute("src",e.src),n.setAttribute("frameborder",0),n.setAttribute("allowfullscreen",""),n.setAttribute("allow","autoplay;encrypted-media"),"vine"===e.vendor&&((e=document.createElement("script")).setAttribute("src","https://platform.vine.co/static/scripts/embed.js"),t.appendChild(e));return t.appendChild(n),t}(e.settings),e.settings.thumbnail&&t&&(e.el.style.backgroundImage="url("+e.settings.thumbnail+")"),e.settings.title&&0===e.el.children.length&&(t=document.createDocumentFragment(),(n=document.createElement("span")).className="lazyframe__title",n.innerHTML=e.settings.title,t.appendChild(n),e.el.appendChild(t)),s.lazyload||(e.el.classList.add("lazyframe--loaded"),e.settings.onLoad.call(this,e),a.push(e)),e.settings.initialized||a.push(e)}});